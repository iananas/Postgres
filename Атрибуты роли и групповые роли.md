# Атрибуты роли и групповые роли
#### Атрибуты ролей в Postgres
Атрибуты необходимы для задания пользователю(роли) определённых полномочий.
Право на подключение даёт атрибут **LOGIN**(при создании пользователя командой **CREATE USER** атрибут дейтвует по умолчанию). Создадим такого пользователя.
![avatar](https://sun9-62.userapi.com/impg/xUGhOSR3CwCYe5RYuzhjLhG1lxkpQjBZHH_wQQ/Qd14nDW2c00.jpg?size=637x157&quality=96&sign=598085de27894d4c90b07dc2eeea847a&type=album)
Атрибут **SUPERUSER** даёт роли права супер пользователя. Однако этого делать не рукомендуется, так как это опасная привилегия и она не должна использоваться небрежно.
>Роль должна явно иметь разрешение на создание базы данных (за исключением суперпользователей, которые пропускают все проверки).
>
 Для задания нашей роли такого атрибута воспользуемся следующей командой **ALTER ROLE имя CREATEDB**.
![avatar](https://sun9-84.userapi.com/impg/12JTMgbPtCHt7LnPOuOi8eP5Tuhk5hYhPBSQbw/nFWmsFubQaY.jpg?size=639x122&quality=96&sign=478818f4040f5bcca0cde5f40930d59d&type=album)
Теперь дадим роли атрибут создания других ролей **ALTER ROLE имя CREATEROLE**. Так же атрибут даст нашей роли создавать, удалять и изменять новые роли, а также выдавать и отзывать членство в ролях(за исключением ролей "суперпользователь").
![avatar](https://sun9-30.userapi.com/impg/WWMz_MMH6LS02k00AP9BV7HbAwR95b02LjO3Cw/gUeSH9PYffs.jpg?size=644x166&quality=96&sign=5c9f57126abe516ab890317dba222f49&type=album)
Также роль должна иметь явное разрешение на запуск потоковой репликации (за исключением суперпользователей, которые пропускают все проверки). Роль, используемая для потоковой репликации, также должна иметь атрибут LOGIN(В нашем случае он уже есть). Для задания роли такого разрешения используем атрибут **REPLICATION**. Обновим нашу роль.
![avatar](https://sun9-63.userapi.com/impg/e1J1Cr_Gl5P_gDxOMEDMJ6xltCQGfXkuGoJZbg/h8Z0HGJbeOo.jpg?size=632x129&quality=96&sign=317df02dd9db29588c61107dbec9e072&type=album)
Теперь наша роль обладает выше перечисленными правами.
#### Членство в другой роли
Часто у многих пользователей могут быть одни и те же права, для того чтобы оптимизовать процесс задания этих прав, роли группируются, права можно выдавать для всей группы и у всей группы забирать. В Postgres для этого создаётся роль, представляющая группу, а затем членство в этой группе выдаётся ролям индивидуальных пользователей.Обычно групповая роль не имеет атрибута LOGIN, хотя при желании его можно установить. Создадим такую роль.
![avatar](https://sun9-9.userapi.com/impg/DLR56SL2bCuN3f8BPidaV1RzawahOvY9CeX27g/sqBnVUzkK1k.jpg?size=632x186&quality=96&sign=0aee6ca1c5d028c3fa7acd219ece36f9&type=album)
После того как групповая роль создана, мы можем добавлять в неё членов или удалять их, используя команды **GRANT** и **REVOKE**.
Зададим групповой роли права создания БД.
![avatar](https://sun9-41.userapi.com/impg/Xmu4_cJOvsV64bPKcdpCNHDKsimxEgqDqnihdA/1T7IYk4ZXfQ.jpg?size=605x172&quality=96&sign=08abd7ab8004e94de00d097d2f609895&type=album)
Теперь создадим ещё одну роль и предоставим ей членство в нашей групповой роли.
![avatar](https://sun9-85.userapi.com/impg/1gj_x3IO-DwhyJKAMx9of2FC5m_cFT8EHXvLaw/JCgVlRS8do0.jpg?size=690x197&quality=96&sign=ed1b66aeed9fd6a7f411f17802a622e3&type=album)
Таким же образом мы можем давать права на изменения в определённых таблицах или даже столбцах(Например давать права только чтения из таблиц).
Лишение роли прав осуществляется командой **REVOKE**, однако сделать это может пользователь, который дал это право(В нашем случае это суперпользователь postgres). Заберём права группы у нашего user_to_to.
![avatar](https://sun9-85.userapi.com/impg/1gj_x3IO-DwhyJKAMx9of2FC5m_cFT8EHXvLaw/JCgVlRS8do0.jpg?size=690x197&quality=96&sign=ed1b66aeed9fd6a7f411f17802a622e3&type=album)
Видим, что у user_to_to снова нет прав.

